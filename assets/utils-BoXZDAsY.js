const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./symbolLayerUtils-CBY8tea-.js","./index-BF2r6OBf.js","./index-sCZx1VM2.css","./LRUCache-DFHNnhoO.js","./MemCache-gXXckRz_.js"])))=>i.map(i=>d[i]);
import{aB as s,gD as y,gE as m,gF as b,gG as w,gH as g,_ as k}from"./index-BF2r6OBf.js";import{S as L,u as v}from"./cimSymbolUtils-C51asCt6.js";import{e as z}from"./LRUCache-DFHNnhoO.js";new z(1e3);new s([128,128,128]);function G(r){if(r==null||!("symbolLayers"in r)||r.symbolLayers==null)return!1;switch(r.type){case"point-3d":return r.symbolLayers.some(n=>n.type==="object");case"line-3d":return r.symbolLayers.some(n=>n.type==="path");case"polygon-3d":return r.symbolLayers.some(n=>n.type==="object"||n.type==="extrude");default:return!1}}function H(r){return r.resource?.href??""}function I(r,n){if(!r)return null;let o=null;return y(r)?o=S(r):m(r)&&(o=r.type==="cim"?v(r):r.color?new s(r.color):null),o?u(o,n):null}function S(r){const n=r.symbolLayers;if(!n)return null;let o=null;return n.forEach(l=>{l.type==="object"&&l.resource?.href||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new s(o):null}function u(r,n){if(n==null||r==null)return r;const o=r.toRgba();return o[3]=o[3]*n,new s(o)}function _(r,n,o){const l=r.symbolLayers;if(!l)return;const e=(t,c=!1)=>{let i=n??t??null;return o?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=o.override)),u(i,o?.add)};l.forEach(t=>{if(t.type==="water")return void(t.color=u(t.color,o?.add));const c=t.material!=null?t.material.color:null,i=e(c,t.type==="icon"&&t.resource?.href!=null);t.material==null?t.material=new b({color:i}):t.material.color=i,"outline"in t&&t.outline?.color&&o?.add!=null&&(t.outline.color=u(t.outline.color,o.add)),"marker"in t&&t.marker!=null&&(t.marker.color=e(t.marker.color))})}function x(r,n,o){n=n??r.color,o?.override!=null&&n&&(n.a=o.override),n&&(r.color=u(n,o?.add)),"outline"in r&&r.outline?.color&&(r.outline.color=u(r.outline.color,o?.add))}function J(r,n,o){r&&(n||o!=null)&&(n&&(n=new s(n)),y(r)?_(r,n,o):m(r)&&x(r,n,o))}async function j(r,n){const o=r.symbolLayers;o&&await w(o,async l=>E(l,n))}async function E(r,n){switch(r.type){case"extrude":R(r,n);break;case"icon":case"line":case"text":$(r,n);break;case"path":O(r,n);break;case"object":await D(r,n)}}function $(r,n){const o=h(n);o!=null&&(r.size=o)}function h(r){for(const n of r)if(typeof n=="number")return n;return null}function R(r,n){const o=n[2];typeof o=="number"&&(r.size=o)}async function D(r,n){const{resourceSize:o,symbolSize:l}=await A(r),e=p(n,o,l);e!=null&&(r.width=f(n[0],l[0],o[0],e),r.depth=f(n[1],l[1],o[1],e),r.height=f(n[2],l[2],o[2],e))}function O(r,n){const o=p(n,g,[r.width,void 0,r.height]);o!=null&&(r.width=f(n[0],r.width,1,o),r.height=f(n[2],r.height,1,o))}function p(r,n,o){for(let l=0;l<3;l++){const e=r[l];switch(e){case"symbol-value":{const t=o[l];return t!=null?t/n[l]:1}case"proportional":break;default:if(e&&n[l])return e/n[l]}}return null}async function A(r){const{computeObjectLayerResourceSize:n}=await k(()=>import("./symbolLayerUtils-CBY8tea-.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url),o=await n(r,10),{width:l,height:e,depth:t}=r,c=[l,t,e];let i=1;for(let a=0;a<3;a++){const d=c[a];if(d!=null){i=d/o[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=o[a]*i);return{resourceSize:o,symbolSize:c}}function f(r,n,o,l){switch(r){case"proportional":return o*l;case"symbol-value":return n??o;default:return r}}function P(r,n){const o=h(n);if(o!=null)switch(r.type){case"simple-marker":r.size=o;break;case"picture-marker":{const l=r.width/r.height;l>1?(r.width=o,r.height=o*l):(r.width=o*l,r.height=o);break}case"simple-line":r.width=o;break;case"text":r.font.size=o}}async function M(r,n){if(r&&n)return y(r)?j(r,n):void(m(r)&&P(r,n))}function N(r,n,o){if(r&&n!=null){if(y(r)){const l=r.symbolLayers;l&&l.forEach(e=>{if(e.type==="object")switch(o){case"tilt":e.tilt=(e.tilt??0)+n;break;case"roll":e.roll=(e.roll??0)+n;break;default:e.heading=(e.heading??0)+n}e.type==="icon"&&(e.angle+=n)})}else if(m(r))switch(r.type){case"simple-marker":case"picture-marker":case"text":r.angle+=n;break;case"cim":L(r,n,!0)}}}function T(r){return r!=null&&r.type==="polygon-3d"&&r.symbolLayers.some(n=>n.type==="extrude")}export{T as A,J as L,M,N,I as b,H as d,G as h};
