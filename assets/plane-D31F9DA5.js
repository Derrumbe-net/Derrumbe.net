import{eQ as b,dU as S,d$ as j,dS as s,dT as U,dY as f,e6 as T,e7 as y,eC as D,en as Q,dR as m,ct as E}from"./index-BF2r6OBf.js";import"./vec42-C_SBvOcS.js";import{r as F,c as i,f as R}from"./vectorStacks-DRnKQhDr.js";function nt(n){const t=n[0]*n[0]+n[4]*n[4]+n[8]*n[8],r=n[1]*n[1]+n[5]*n[5]+n[9]*n[9],e=n[2]*n[2]+n[6]*n[6]+n[10]*n[10];return Math.sqrt(Math.max(t,r,e))}function rt(n,t){const r=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),e=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),u=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return b(n,r,e,u),n}function G(n,t,r){Math.abs(n[0])>Math.abs(n[1])?b(t,0,1,0):b(t,1,0,0),S(r,n,t),S(t,r,n),j(r,r),j(t,t)}function et(n,t,r,e=s()){const u=U(n),a=U(t),o=f(n,t)/(u*a);if(o<.9999999999999999){const c=Math.acos(o),h=((1-r)*u+r*a)/Math.sin(c),$=h/u*Math.sin((1-r)*c),M=h/a*Math.sin(r*c);return y(Y,n,$),y(_,t,M),T(e,Y,_)}return D(e,n,t,r)}const Y=s(),_=s();function k(n=q){return[n[0],n[1],n[2],n[3]]}function ut(n=q[0],t=q[1],r=q[2],e=q[3]){return w(n,t,r,e,F.get())}function J(n,t){return w(t[0],t[1],t[2],t[3],n)}function ct(n){return n}function w(n,t,r,e,u=k()){return u[0]=n,u[1]=t,u[2]=r,u[3]=e,u}function K(n,t,r){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],u=Math.abs(e-1)>1e-5&&e>1e-12?1/Math.sqrt(e):1;return r[0]=t[0]*u,r[1]=t[1]*u,r[2]=t[2]*u,r[3]=-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2]),r}function L(n,t,r,e=k()){const u=r[0]-t[0],a=r[1]-t[1],o=r[2]-t[2],c=n[0]-t[0],h=n[1]-t[1],$=n[2]-t[2],M=a*$-o*h,C=o*c-u*$,H=u*h-a*c,I=M*M+C*C+H*H,P=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return e[0]=M*P,e[1]=C*P,e[2]=H*P,e[3]=-(e[0]*n[0]+e[1]*n[1]+e[2]*n[2]),e}function z(n,t,r,e=0,u=Math.floor(r*(1/3)),a=Math.floor(r*(2/3))){if(r<3)return!1;t(d,e);let o=u,c=!1;for(;o<r-1&&!c;)t(l,o),o++,c=!Q(d,l);if(!c)return!1;for(o=Math.max(o,a),c=!1;o<r&&!c;)t(g,o),o++,m(x,d,l),j(x,x),m(A,l,g),j(A,A),c=!Q(d,g)&&!Q(l,g)&&Math.abs(f(x,A))<N;return c?(L(d,l,g,n),!0):(e!==0||u!==1||a!==2)&&z(n,t,r,0,1,2)}function ot(n,t,r=!0){const e=t.length/3;return z(n,(u,a)=>b(u,t[3*a+0],t[3*a+1],t[3*a+2]),r?e-1:e)}const N=.99619469809,d=s(),l=s(),g=s(),x=s(),A=s();function at(n,t,r){return t!==n&&J(n,t),n[3]=-f(n,r),n}function it(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function st(n,t,r,e){return S(g,t,n),K(r,g,e)}function ft(n,t,r,e){return v(B(n,t,m(i.get(),r,t),V,e))}function ht(n,t,r){return t!=null&&v(B(n,t.origin,t.direction,W,r))}function Mt(n,t,r){return v(B(n,t.origin,t.vector,0,r))}function gt(n,t,r){return v(B(n,t.origin,t.vector,1,r))}function $t(n,t){return p(n,t)>=0}function lt(n,t){const r=f(n,t.ray.direction),e=-p(n,t.ray.origin);if(e<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return e>0;if((e<0||r<0)&&!(e<0&&r<0))return!0;const u=e/r;return r>0?u<t.c1&&(t.c1=u):u>t.c0&&(t.c0=u),t.c0<=t.c1}function mt(n,t){const r=f(n,t.ray.direction),e=-p(n,t.ray.origin);if(r>-1e-6&&r<1e-6)return e>0;const u=e/r;return r>0?u<t.c1&&(t.c1=u):u>t.c0&&(t.c0=u),t.c0<=t.c1}function dt(n,t,r){const e=y(i.get(),n,-n[3]),u=O(n,m(i.get(),t,e),i.get());return T(r,u,e),r}function qt(n,t,r,e){const u=n,a=i.get(),o=i.get();G(u,a,o);const c=m(i.get(),r,t),h=R(a,c),$=R(o,c),M=R(u,c);return b(e,h,$,M)}function O(n,t,r){const e=y(i.get(),n,f(n,t));return m(r,t,e),r}function bt(n,t){return Math.abs(p(n,t))}function p(n,t){return f(n,t)+n[3]}function v(n){return n===0||n===1}function B(n,t,r,e,u){const a=f(n,r),o=p(n,t);if(a===0)return o>=0?2:3;let c=-o/a;return 1&e&&(c=E(c,0,1)),!(4&e)&&c<0||!(8&e)&&c>1?o>=0?2:3:(T(u,t,y(u,r,c)),o>=0?0:1)}const q=[0,0,1,0],V=12,W=8;export{at as G,it as H,st as I,ft as J,ht as K,Mt as L,gt as N,$t as O,lt as P,mt as Q,dt as R,z as S,qt as T,K as U,bt as W,p as X,B as Z,G as a,et as b,ut as d,rt as g,k as j,ct as k,nt as m,w as q,L as w,J as y,ot as z};
